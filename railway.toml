[build]
builder = "dockerfile"

[deploy]
startCommand = "docker-compose -f docker-compose.production.yml up --build"
healthcheckPath = "/api/health"
healthcheckTimeout = 100
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

# Railway will automatically detect services from docker-compose.production.yml
# The following service definitions help with configuration

[services.backend]
name = "rtims-backend"
dockerfilePath = "backend/Dockerfile"
watchPatterns = ["backend/**"]

[services.frontend]
name = "rtims-frontend"
dockerfilePath = "frontend/Dockerfile"
watchPatterns = ["frontend/**"]

[services.database]
name = "rtims-database"
dockerfilePath = "database/Dockerfile.migrator"
watchPatterns = ["database/**"]

[services.redis]
name = "rtims-redis"
image = "redis:7-alpine"